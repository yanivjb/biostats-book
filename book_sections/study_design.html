<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>25. Study Design – Applied Biostatistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../book_sections/causal_inference.html" rel="next">
<link href="../book_sections/model_evaluation.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-710ea84994903bc41163d01235b9627e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-82a15b99bf7720207ddddc281aa6ceca.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding/datatables.js"></script>
<script src="../site_libs/jquery/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/crosstalk/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../assets/sticky-notes.css">
<link rel="stylesheet" href="../assets/table-styles.css">
<link rel="stylesheet" href="../assets/webex.css">
</head>

<body class="nav-sidebar floating slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book_sections/study_design.html">25. Study Design</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../figs/fun_figs/stamp.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Applied Biostatistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/clarkia_and_its_data/clarkia_and_its_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motivating biology and datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/example_mini/varType.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Types of Variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/filler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">—————————————</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/intro2r_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SECTION I: Intro to R</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Getting started with R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/getting_started/functions_and_vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 1. Functions and vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/getting_started/loading_packages_and_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 1. Load packages and data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/getting_started/data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 1. Data types in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/getting_started/rstudio_orientation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 1. Orientation to RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/getting_started/getting_started_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 1. Getting started summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/data_in_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Data in R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_in_R/add_vars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 2. Adding columns w mutate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_in_R/select_vars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 2. Selecting columns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_in_R/summarize_vars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 2. Summarizing columns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_in_R/choose_rows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 2. Choose rows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_in_R/data_in_R_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 2. Data in R summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/intro_to_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Introduction to ggplot</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/intro_to_ggplot/one_continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 3. A continuous variable</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/intro_to_ggplot/saving_ggplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 3. Saving a ggplot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/intro_to_ggplot/cont_cat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 3. Continuous y/categorical x</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/intro_to_ggplot/two_categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 3. Two categorical variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/intro_to_ggplot/two_continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 3. Two continuous variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/intro_to_ggplot/many_explanatory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 3. Many explanatory vars</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/intro_to_ggplot/ggplot_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 3. ggplot summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/reproducible_science.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Reproducible Science</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/reproducible_science/collecting_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 4. Collecting data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/reproducible_science/reproducible_analyses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 4. Reproducible analyses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/reproducible_science/reproducible_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 4. Reproducibility summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/filler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">—————————————</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/summarizing_data_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Section II: Summarizing data</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/univariate_summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Simple Summaries</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/univariate_summaries/summarizing_shape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 5. Summarizing shape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/univariate_summaries/changing_shape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 5. Changing shape</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/univariate_summaries/summarizing_center.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 5. Summarizing the center</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/univariate_summaries/summarizing_variability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 5. Summarizing variability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/univariate_summaries/summarizing_summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 5. Summarizing summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/associations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Associations</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/associations/cat_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 6. Categorical + numeric</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/associations/two_categorical_vars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 6. Two categorical vars</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/associations/cont_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 6. Two numeric vars</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/associations/summarizing_associations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 6. Association Summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Linear Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/linear_models/mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 7. Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/linear_models/lm_cat_pred.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 7. Categorical predictor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/linear_models/regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 7. Linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/linear_models/two_predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 7. Two predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/linear_models/lm_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 7. Linear model summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Ordination</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/ordination/pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 8. PCA quick start</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/ordination/pcaII.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 8. PCA deeper dive</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/ordination/pcaIII.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 8. PCA – Gotchas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/ordination/pcalternatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 8. PCAlternatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/ordination/ordination_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 8. Ordination summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/data_viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Better Figures</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_viz/audience&amp;delivery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 9. Audience &amp; Format</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_viz/honest_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 9. Honest plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_viz/transparent_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 9. Transparent plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_viz/clear_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 9. Clear plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_viz/avoid_distractions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 9. Avoid Distractions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_viz/accessible_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 9. Accessible Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_viz/writing_about_figures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 9. Writing about plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/data_viz/dataviz_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 9. Dataviz Summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/betteR_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Better Figures in R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/betteR_plots/plotting_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 10. Tools for BetteR plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/betteR_plots/cleaR_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 10. Making cleaR plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/betteR_plots/plots_foR_medium.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 10. Plots for the medium</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/betteR_plots/betteR_plots_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 10. Better ggplots summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/filler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">—————————————</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/stats_foundation_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Section III: Stats Foundations</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/sampling_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Intro to Sampling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/sampling/sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 11. Sampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/sampling/sampling_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 11. Sampling Error</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/sampling/sampling_bias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 11. Sampling Bias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/sampling/nonindependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 11. Non-independence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/sampling/better_sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 11. Sampling Better</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/sampling/sampling_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 11. Sampling summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Uncertainty</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/uncertainty/bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 12. Bootstrap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/uncertainty/ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 12. Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/uncertainty/boot_infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 12. Bootstrapping w/<code>infer</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/uncertainty/boot_gotchas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 12. Gotchas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/uncertainty/uncertainty_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 12. Uncertainty summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/nhst.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Null Hypothesis Significance Testing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/nhst/statistical_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 13. Statistical Hypotheses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/nhst/p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 13. P Values</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/nhst/statistical_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 13. Statistical Significance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/nhst/nhst_gotchas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 13. Considerations for NHST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/nhst/nhst_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 13. NHST summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/shuffling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Shuffling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/shuffling/the_frogs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 14. The frogs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/shuffling/permute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 14. Permute</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/shuffling/permute_nonindependent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 14. Structured Permutation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/shuffling/shuffling_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 14. Shuffling summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/chi2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14-B. χ2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/chi2/expectations_and_differences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 14B. What to expect</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/chi2/associations_between_catvars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 14B. <span class="math inline">\(\chi^2\)</span> Two Cats</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/chi2/chi2_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 14B. <span class="math inline">\(\chi^2\)</span> distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/chi2/chi2_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 14B. <span class="math inline">\(\chi^2\)</span> summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/filler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">—————————————</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/stats_4_linear_models_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Section IV: Stats for Linear Models</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. Normal distribution</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/normal/normal_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 15. Normal Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/normal/normal_properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 15. Normal Properties</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/normal/noRmal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 15. Normal Simulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/normal/p_norm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 15. Normal Math</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/normal/is_it_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 15. Is It Normal?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/normal/clt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 15. The Normal is Common</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/normal/transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 15. Make It Normal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/normal/normal_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 15. Normal Summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16. The t distribution</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/t/t_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 16. t: Example Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/t/summaries_4_t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 16. Data summaries for t</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/t/t_assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 16. Assumptions of t</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/t/t_CI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 16. Uncertain-t</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/t/one_sample_t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 16. One sample t-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/t/one_sample_t_test_in_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 16. One sample t-test in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/t/paired_t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 16. The “Paired” t-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/t/t_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 16. t Summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/two_ts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17. A binary explanatory variable</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/two_ts/2t_assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 17. Two-t Assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/two_ts/2t_calcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 17. Two-t Calculations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/two_ts/uncertain2t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 17. Uncertain-2t</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/two_ts/nhs2t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 17. Two-sample t-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/two_ts/2t_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 17. Two t Summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/f.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18. F this!</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/f/from_sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 18. F the ratio of variance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/f/f_calcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 18. F Calculations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/f/FR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 18. F and anova in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/f/Finding_connections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 18. F-inding connecTions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/f/f_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 18. F (ANOVA) summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book_sections/anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19. &gt;2 Categories</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/anova/multiple_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 19. Multiple testing problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/anova/anova_lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 19. ANOVA: a linear model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/anova/anova_assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 19. ANOVA assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/anova/anova_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 19. ANOVA Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/anova/post_hoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 19. Post hoc tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/anova/sig_groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 19. Significance groups</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/anova/Ranova_pipeline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 19. R ANOVA pipeline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/anova/anova_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">• 19. ANOVA summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">20. Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/two_predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">21. Two predictors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/multiple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">22. Multiple Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">23. Interactions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/model_evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">24. Model Evaluation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/study_design.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">25. Study Design</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/causal_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">26. Cause</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_sections/probability_and_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">27. Probability and Likelihood</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="study_design" class="quarto-section-identifier">25. Study Design</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="motivation" style="background-color: #ffe6f7; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
<p><strong>Motivating Scenario:</strong> You are about to conduct a scientific study (or critically evaluate the results from a completed one) and want to know what design gives you the best chance of testing your scientific hypothesis effectively and fairly.</p>
<p><strong>Learning Goals:</strong> By the end of this chapter, you should be able to:</p>
<ul>
<li><strong>Explain how randomization</strong> allows us to make causal claims.</li>
<li><strong>Identify common sources of experimental bias</strong> and describe how to avoid them.</li>
<li><strong>Define pseudo-replication,</strong> explain why it is a problem, and recognize how to prevent it.</li>
<li><strong>Plan for sufficient power and precision</strong> — at least conceptually, even if not calculating it in detail.</li>
<li><strong>Recognize best practices</strong> for making inferences from observational (non-experimental) studies.</li>
</ul>
</div>
<section id="review-set-up" class="level1 page-columns page-full">
<h1>Review / Set Up</h1>
<blockquote class="blockquote">
<p>To consult the statistician after an experiment is finished is often merely to ask him to conduct a post mortem examination. He can perhaps say what the experiment died of.</p>
<footer>
— R.A. Fisher, “Presidential Address to the First Indian Statistical Congress,” 1938.
</footer>
</blockquote>
<p>So far we have focused on two goals of statistics:</p>
<ul>
<li><p><strong>Estimation (with uncertainty)</strong> — How can we responsibly describe aspects of the world based on our limited perspective from a finite sample?</p></li>
<li><p><strong>Hypothesis testing</strong> — Can a pattern in a sample be reasonably explained by the vagaries of sampling from a “null” distribution, or is that explanation unlikely?</p></li>
</ul>
<p>These are reasonable aims. But too much focus on significance testing and uncertainty can blur the bigger picture. Our statistical expertise and efforts are wasted if we don’t critically evaluate the implications of a study. This brings us to our third – and in my view, the most important – goal of statistics:</p>
<ul>
<li><strong>Inferring causation</strong> — How can we determine what process(es) generate the statistical pattern we detect (or failed to detect) in our data?</li>
</ul>
<p>As we work through this goal, we will transition from dealing with other people’s data to designing our own scientific studies. There are two excellent reasons for this: <strong>(1)</strong> Many of you will conduct some form of scientific study during your career. <strong>(2)</strong> Even if you never conduct a scientific study, learning how to design a good study helps you understand both the reasoning behind and the shortcomings of scientific studies and claims.</p>
<hr>
<div class="note">
<p>When considering the implications of a study, it’s important to reflect on its goals and overall message:</p>
<ul>
<li><p>If the goal is simply to make a prediction, causation isn’t a concern. Instead, we focus on issues like sampling bias, sampling error, and other sources of uncertainty.</p></li>
<li><p>However, many studies aim to make causal claims. For example, if I’m thinking about exercising regularly to increase my lifespan, I don’t just want to know if people who exercise tend to live longer—they might live longer due to other factors, like a healthier diet. What I truly want to know is whether taking up exercise is likely, on average, to increase my lifespan.</p></li>
</ul>
</div>
<hr>
<section id="correlation-does-not-necessarily-imply-causation" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="correlation-does-not-necessarily-imply-causation">Correlation Does Not Necessarily Imply Causation</h3>
<p>What does this mean? It’s not just about <span class="math inline">\(r\)</span>. Rather, it’s a reminder that statistical associations between two variables, A and B, do not necessarily mean that B caused A. For example, if <code>lm(A ~ B) %&gt;% anova()</code> yields a p-value &lt; 0.05, we <strong>cannot</strong> automatically conclude that B caused A. A p-value only tells us how incompatible the data are with the null model, not what is responsible for this incompatibility. It could be that A causes B, both are caused by a third variable C, or the result could even be a false positive (<a href="#fig-poscause" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>, see also <a href="https://ybrandvain.github.io/biostats/book_sections/associations.html#correlation-is-not-causation">our earlier chapter</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-poscause" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-poscause-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../figs/old/explanations.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-poscause-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Possible causal relationships underlying significant associations. In this example, we would call C a <strong>confounding variable</strong>.
</figcaption>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><strong>A confounding variable</strong> is an unmodeled variable that distorts the relationship between explanatory and response variables, potentially biasing our interpretation.</p>
</div></div><hr>
<p><strong>Watch 8:02 to 10:26 of this <a href="https://www.youtube.com/embed/GtV-VYdNt_g?start=482&amp;end=627">video</a>, Correlation Doesn’t Equal Causation</strong> from Crash Course Statistics, below</p>
<div class="cell" data-layout-align="center">
<iframe src="https://www.youtube.com/embed/GtV-VYdNt_g?start=482&amp;end=623" width="95%" height="400px" data-external="1" allowfullscreen="">
</iframe>
</div>
</section>
<section id="experiments-one-weird-trick-to-infer-causation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="experiments-one-weird-trick-to-infer-causation">Experiments: One weird trick to infer causation</h2>
<p>By randomly assigning individuals to treatment groups, experiments can provide evidence of causation, because randomization breaks any link between the treatment and other variables that might otherwise confound the results.</p>
<p>Of course, like all of statistics, an experiment represents a single sample. So we must be aware of potential issues regarding sampling bias and sampling error, and plan accordingly.</p>
<section id="potential-biases-in-experiments" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="potential-biases-in-experiments">Potential Biases in Experiments</h3>
<p>Poorly executed experiments can introduce bias. This is bad because the whole point of an experiment is to remove confounds and bias. Here are some common ways in which experiments can introduce bias and how to avoid these issues</p>
<ul>
<li><p><strong>Time heals</strong> Whenever I feel terribly sick, I call the doctor, and usually get an appointment the following week. Most of the time I get better before seeing the doctor. I therefore joke that the best way for me to get better is to schedule a doctor appointment. Of course, calling the Doctor didn’t heal me. Rather I called the Doctor when I felt my worst, and got better with time. This is because we tend to get better. <br><br></p></li>
<li><p><strong>“Regression to the mean”</strong> The most extreme observations in a study are biased estimates of the true parameter values. That’s because being exceptional requires both an expectation of being exceptional (extreme <span class="math inline">\(\widehat{Y_i}\)</span>) and a residual in the same direction (a large positive residual for high values or a large negative residual for low ones). Because extreme values partly reflect random noise, that noise is unlikely to repeat in the same direction on a second measurement. As a result, extreme observations tend to move closer to the average, even without any experimental intervention. <br><br></p></li>
<li><p><strong>Experimental artifacts</strong> The experimental manipulation itself, rather than the treatment we care about could be causing the experimental result. Says we hypothesize that birds are attracted to red, so we glue red feathers onto some birds and see that that increases their mating success. We want to make sure that it is the red color, not the glue or added feathers that drives this elevated attractiveness. <br><br></p></li>
<li><p><strong>Known treatments</strong> are a special kind of experimental artifact. Knowledge of the treatment by either the experimental subject or the experimenter, can introduce a bias. For example, people who think they have gotten treated might prime themselves for improvement. Processes like these are known as a placebo effect. Or, if the researchers know the treatment they may subconsciously bias their measurements or the way the treat their subjects. <br><br></p></li>
</ul>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><strong>Listen</strong> to the 7 minute clip from <a href="https://www.wnycstudios.org/podcasts/radiolab/segments/91540-pinpointing-the-placebo-effect">radiolab</a>, below for examples of the placebo and how it may work. <br><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<audio controls="">
<source src="../figs/old/placebo.mp3" type="audio/mp3">
</audio>
</div>
</div>
</div></div><p><strong>Eliminating Bias in Experiments:</strong> To minimize bias and allow for causal interpretation of experimental results, strong experimental designs usually include</p>
<ul>
<li><p><strong>Introducing effective controls</strong> It’s usually a good idea to have a “do nothing” treatment as a control, but this is not enough. We should also include a “sham treatment” or “placebo” is identical to the treatment in every way but the treatment itself. Taking our bird feathers example, we would introduce a treatment in which we glued blue feathers, and maybe ne where we glued on black feathers, to ensure the color red was responsible for the elevated attractiveness observed in our study. <br><br></p></li>
<li><p><strong>“Blinding”</strong> If possible, we should do all we can to ensure that neither the experimenter nor the subjet knows which treatment they received. <br><br></p></li>
</ul>
<hr>
<p><strong>Watch this <a href="https://www.youtube.com/embed/kkBDa-ICvyY">video</a>, on controls, placebos and blinding in experimental design</strong> from Crash Course Statistics, below</p>
<div class="cell" data-layout-align="center">
<iframe src="https://www.youtube.com/embed/kkBDa-ICvyY" width="95%" height="400px" data-external="1" allowfullscreen="">
</iframe>
</div>
</section>
<section id="sampling-error-in-experiments" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="sampling-error-in-experiments">Sampling error in experiments</h3>
<p>Sampling bias isn’t our only consideration when planning a study, we would also like to increase our precision by decreasing sampling error.</p>
<p>Recall that sampling error is the chance deviation between an estimate and its true parameter which arises because of the process of sampling, and that we can summarize this as the standard deviation of the sampling distribution (aka the standard error). The standard error is something like the standard deviation divided by the square root of the sample size, so we can minimize sampling error by:</p>
<ol type="1">
<li><strong>Increasing the sample size (and avoid pseudoreplication)</strong><br>
</li>
<li><strong>Decreasing variability</strong></li>
</ol>
<section id="increase-the-sample-size-and-avoid-pseudo-replication" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="increase-the-sample-size-and-avoid-pseudo-replication"><strong>Increase the sample size and avoid pseudo-replication</strong></h4>
<p>Well of course! We learned this as the law of large numbers. But beware the samples you add should be independent, otherwise you will have “pseudo replicated” your study.</p>
<p>Pseudo-replication occurs when we treat non-independent samples as if they were independent replicates. For example, if we fertilize one garden and leave another unfertilized, then measure many plants within each, we might be tempted to treat each plant as a replicate (top of <a href="#fig-pseudorep1" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>). However, these plants share the same soil, light, and microclimate — so they are not independent. The true sample size is the number of gardens, not the number of plants. Because pseudo-replication inflates our apparent sample size, it leads to artificially small standard errors and an excess of false positives.</p>
<p>To avoid pseudo-replication:</p>
<ul>
<li><strong>Have the unit of analysis matches the unit of randomization</strong> (e.g., the garden, not the plants within it, if treatments are applied at the garden level).</li>
<li><strong>Randomize treatments across independent experimental units</strong> (bottom of <a href="#fig-pseudorep1" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>).</li>
<li><strong>Replicate at the level of the treatment (when possible)</strong>, not just within it. E.g., several fertilized and unfertilized gardens, not just several plants per garden.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pseudorep1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="**Diagram comparing pseudo-replication and actual replication in experimental design:**  *Top section (Pseudo-replication)*: Two groups are depicted, Garden 1 (G1) and Garden 2 (G2). Garden 1 receives fertilizer (F), and Garden 2 receives no fertilizer (NF). Each garden has multiple palm trees, but all trees within Garden 1 receive fertilizer, while all trees in Garden 2 do not. This setup illustrates pseudo-replication, where the experimental treatment (fertilizer) is confounded with differences between the two gardens (the environment), making it impossible to separate the effect of the fertilizer from the garden-specific factors. *Bottom section (Actual replication):* Twelve gardens (G1–G12) are shown, each with a single palm tree. Fertilizer (F) and no fertilizer (NF) are randomly assigned to each garden. This illustrates true replication, where the effect of the fertilizer can be independently assessed across different environments because the treatments are randomly distributed, minimizing confounding factors." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pseudorep1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../figs/old/pseudorep.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:95.0%" alt="**Diagram comparing pseudo-replication and actual replication in experimental design:**  *Top section (Pseudo-replication)*: Two groups are depicted, Garden 1 (G1) and Garden 2 (G2). Garden 1 receives fertilizer (F), and Garden 2 receives no fertilizer (NF). Each garden has multiple palm trees, but all trees within Garden 1 receive fertilizer, while all trees in Garden 2 do not. This setup illustrates pseudo-replication, where the experimental treatment (fertilizer) is confounded with differences between the two gardens (the environment), making it impossible to separate the effect of the fertilizer from the garden-specific factors. *Bottom section (Actual replication):* Twelve gardens (G1–G12) are shown, each with a single palm tree. Fertilizer (F) and no fertilizer (NF) are randomly assigned to each garden. This illustrates true replication, where the effect of the fertilizer can be independently assessed across different environments because the treatments are randomly distributed, minimizing confounding factors.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pseudorep1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Comparing pseudo-replication (top) to independent replication (bottom). With pseudo-replication the effect of our experimental intervention (in this case fertilizer), is tied up with differences between environments unrelated to treatment (in this case, differences between gardens). Separating treatment and garden, and randomly placing treatments onto garden removes this issue.
</figcaption>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><strong>Be sure to read <a href="https://drive.google.com/uc?export=download&amp;id=1MBTwopPWgNzEHFmJC1aUKuqak8pAni4X">Interleaf 2 on pseudo-replication</a> from <span class="citation" data-cites="whitlock2020">Whitlock &amp; Schluter (<a href="../references.html#ref-whitlock2020" role="doc-biblioref">2020</a>)</span>.</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pseudoread" class="quarto-float quarto-figure quarto-figure-center anchored" width="95%" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pseudoread-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../figs/old/pseudorepRead.jpeg" id="fig-pseudoread" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-pseudoread-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3
</figcaption>
</figure>
</div>
</div>
</div>
</div></div></section>
<section id="decrease-external-variability." class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="decrease-external-variability."><strong>Decrease (external) variability</strong>.</h4>
<p>We want to minimize the variability unrelated to our treatment, but how? Well, we only have so much control of this because some variability is natural. Still there are things we can do to increase the precision of our estimated effect and minimize extraneous variation.</p>
<ul>
<li><strong>More precise measurements</strong> More careful counting, fancier machines etc etc can provide more accurate measurements for each individual in our sample and eliminating this extraneous variability should decrease variability in our sample.</li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="study_design_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:95.0%"></p>
</figure>
</div>
</div></div></div>
<ul>
<li><p><strong>Balanced design</strong> Balance refers to the similarity in sample sizes for each treatment. Recall that <span class="math inline">\(SE_{\overline{Y_1}-\overline{Y}_2} = \sqrt{s_p^2(\frac{1}{n_1}+\frac{1}{n_2})}\)</span>. So, for a fixed total sample size, more balanced experiments decrease uncertainty mean differences between treatments. <br><br></p></li>
<li><p><strong>Matching / Blocking</strong> A standard experimental design is two randomize who gets the treatment and who get the control. But we can do even better than that!!! <a href="https://bookdown.org/ybrandvain/Applied_Biostats_2024/23-2t.html">We have seen</a> that a paired t-test gets extra power by comparing natural pairs who are alike in many ways except the treatment. This design decreases variability in our estimated difference because in each pairs we minimize extraneous variation unrelated to treatment. We can scale that principle up to larger studies ANOVAs etc….</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/old/blockin.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="planning-for-power-and-precision" class="level2">
<h2 class="anchored" data-anchor-id="planning-for-power-and-precision">Planning for power and precision</h2>
<p>We could maximize our power and precision by having an infinitely large sample, but this is obviously silly. We’d be wasting a bunch of time and resources over-doing one study and will miss out on so many others. So, how do we plan a study that is big enough to satisfy our goals, without overdoing it?</p>
<p><strong>We need to think about the effect size we care about and the likely natural variability</strong></p>
<ul>
<li>How precise of an estimate do we need for our biological story? In some cases, small difference mean a lot, in other cases, ballpark estimates are good enough. It’s your job as the researcher to know what is needed for your question.<br>
</li>
<li>What effect size is worth knowing about? The null hypothesis is basically always false. With an infinite sample size, we’d probably always reject it. But in many of these cases, the true population parameter is so close to zero, that the null hypothesis might as well be true. Again, it’s your job as a researcher to consider what size of an effect you would like to be able to see.<br>
</li>
<li>How much variability do we expect between measurements. Again, your biological knowledge is required here (or you could consider difference relative to variability when considering precision and effect size of interest)</li>
</ul>
<section id="estimating-an-appropriate-sample-size." class="level3">
<h3 class="anchored" data-anchor-id="estimating-an-appropriate-sample-size.">Estimating an appropriate sample size.</h3>
<p>We use power analyses to plan appropriate sample sizes for a study. A power analysis basically finds the sample size necessary so that the sampling distribution of your experiment has</p>
<ul>
<li>Some specified power to differentiate between the null model and the smallest effect size that you would like to be able to identify and/or</li>
<li>Probability of being as or more precise than you want.</li>
</ul>
<p>The traditional specified power researchers shot for is 80%, but in my opinion that is quite low and aiming for 90% power seems more reasonable.</p>
<p>The are numerous mathematical rules of thumb for power analyses, as well as online plugins <a href="https://www.stat.ubc.ca/~rollin/stats/ssize/n2.html">e.g.&nbsp;this one from UBC</a> and R packages (<a href="https://cran.r-project.org/web/packages/pwr/index.html"><code>pwr</code></a> is most popular)</p>
<div class="warning">
<p>The sample size we start with is rarely the sample size we end with – plants die, people drop out, RNA degrades etc etc. Keep this in mind when designing your experiment, and increase your sample size to accommodate the expected number of lost data points.</p>
</div>
</section>
<section id="example-with-the-pwr-package" class="level3">
<h3 class="anchored" data-anchor-id="example-with-the-pwr-package">Example with the <code>pwr</code> package</h3>
<p>The <a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html"><code>pwr package</code></a> helps you evlaute power for numerous standard statistical procedures. Say you wanted to design a study that you would analyze with a t-test, and you wanted a ninety percent chance of rejecting the null if the true population value of Cohen’s D was 1.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">power =</span> .<span class="dv">9</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">d =</span> <span class="dv">1</span>,  <span class="co"># Effect size (Cohen's d)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="co"># Significance level</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 22.02109
              d = 1
      sig.level = 0.05
          power = 0.9
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p>Or say you wanted to know the power you had to reject the null if the true COhen’s D was 2 and you did and experiment with two groups of five samples.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">5</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">d =</span> <span class="dv">2</span>,  <span class="co"># Effect size (Cohen's d)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="co"># Significance level</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">alternative =</span> <span class="st">"two.sided"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()<span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">g =</span> <span class="dv">2</span>, <span class="at">sig_level =</span> <span class="fl">0.05</span>)                                                                                                                           <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">power =</span> <span class="fu">round</span>(power, <span class="at">digits =</span> <span class="dv">3</span>))<span class="sc">%&gt;%</span><span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="gomvxnwcij" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gomvxnwcij table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gomvxnwcij thead, #gomvxnwcij tbody, #gomvxnwcij tfoot, #gomvxnwcij tr, #gomvxnwcij td, #gomvxnwcij th {
  border-style: none;
}

#gomvxnwcij p {
  margin: 0;
  padding: 0;
}

#gomvxnwcij .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gomvxnwcij .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gomvxnwcij .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gomvxnwcij .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gomvxnwcij .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gomvxnwcij .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gomvxnwcij .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gomvxnwcij .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gomvxnwcij .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gomvxnwcij .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gomvxnwcij .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gomvxnwcij .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gomvxnwcij .gt_spanner_row {
  border-bottom-style: hidden;
}

#gomvxnwcij .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gomvxnwcij .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gomvxnwcij .gt_from_md > :first-child {
  margin-top: 0;
}

#gomvxnwcij .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gomvxnwcij .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gomvxnwcij .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gomvxnwcij .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gomvxnwcij .gt_row_group_first td {
  border-top-width: 2px;
}

#gomvxnwcij .gt_row_group_first th {
  border-top-width: 2px;
}

#gomvxnwcij .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gomvxnwcij .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gomvxnwcij .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gomvxnwcij .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gomvxnwcij .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gomvxnwcij .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gomvxnwcij .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gomvxnwcij .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gomvxnwcij .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gomvxnwcij .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gomvxnwcij .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gomvxnwcij .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gomvxnwcij .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gomvxnwcij .gt_left {
  text-align: left;
}

#gomvxnwcij .gt_center {
  text-align: center;
}

#gomvxnwcij .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gomvxnwcij .gt_font_normal {
  font-weight: normal;
}

#gomvxnwcij .gt_font_bold {
  font-weight: bold;
}

#gomvxnwcij .gt_font_italic {
  font-style: italic;
}

#gomvxnwcij .gt_super {
  font-size: 65%;
}

#gomvxnwcij .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gomvxnwcij .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gomvxnwcij .gt_indent_1 {
  text-indent: 5px;
}

#gomvxnwcij .gt_indent_2 {
  text-indent: 10px;
}

#gomvxnwcij .gt_indent_3 {
  text-indent: 15px;
}

#gomvxnwcij .gt_indent_4 {
  text-indent: 20px;
}

#gomvxnwcij .gt_indent_5 {
  text-indent: 25px;
}

#gomvxnwcij .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gomvxnwcij div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
<th id="sig.level" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">sig.level</th>
<th id="power" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">power</th>
<th id="g" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">g</th>
<th id="sig_level" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">sig_level</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="n">5</td>
<td class="gt_row gt_right" headers="sig.level">0.05</td>
<td class="gt_row gt_right" headers="power">0.791</td>
<td class="gt_row gt_right" headers="g">2</td>
<td class="gt_row gt_right" headers="sig_level">0.05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>See <a href="https://bookdown.org/pdr_higgins/rmrwr/sample-size-calculations-with-pwr.html">Chapter 20: Chapter 20 Sample Size Calculations with {pwr}</a> from <span class="citation" data-cites="higgins2024">Higgins (<a href="../references.html#ref-higgins2024" role="doc-biblioref">2024</a>)</span> for more.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Unfold this section to learn more about simulating to estimate power and precision (optional)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Often experimental design is more complex than the off-shelf options in the <code>pwr</code> package. Of course, we could try to find a package better suited to our study, but sometime we will fail. Here I focus on one way we can estimate power and precision – we can simulate!!! There is a bit on new R in here, including writing functions. Enjoy if you like, skim if you don’t care. I also note that there are more efficient ways to code this in R. I ca provide examples if there is enough demand.</p>
<p>Let’s first write <strong>our own</strong> function to</p>
<ul>
<li>Simulate data from two populations with a true mean difference of <code>x</code> (the minimal value we care about) and a standard deviation of s from a normal distribution.<br>
</li>
<li>Run a two sample t.test.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>simTest <span class="ot">&lt;-</span> <span class="cf">function</span>(n1, n2, x, s){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  sim_id  <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># picka random id, in case you want it</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  sim_dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">treatment   =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>), <span class="at">times =</span> <span class="fu">c</span>(n1, n2)),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">exected_val =</span> <span class="fu">case_when</span>(treatment <span class="sc">==</span> <span class="st">"a"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                            treatment <span class="sc">==</span> <span class="st">"b"</span> <span class="sc">~</span> x)) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sim_val     =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">n</span>(),<span class="at">mean =</span> exected_val, <span class="at">sd =</span> s))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  tidy_sim_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(sim_val <span class="sc">~</span> treatment, <span class="at">data =</span> sim_dat) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">n1 =</span> n1, <span class="at">n2 =</span> n2, <span class="at">x =</span> x, <span class="at">s =</span> s, <span class="at">sim_id =</span> sim_id)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tidy_sim_lm)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>We can see the outcome of one random experiment</strong>, with a sd of 2, and a difference of interest equal to one, and a sample size of twenty for each treatment.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>one_sim <span class="ot">&lt;-</span> <span class="fu">simTest</span>(<span class="at">n1 =</span> <span class="dv">20</span>, <span class="at">n2 =</span> <span class="dv">20</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">s =</span> <span class="dv">2</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>one_sim                                                                                                                                                               <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric,round,<span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span>DT<span class="sc">::</span><span class="fu">datatable</span>( <span class="at">options =</span> <span class="fu">list</span>( <span class="at">scrollX=</span><span class="st">'400px'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-a1b9b3649c9da0a23a00" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a1b9b3649c9da0a23a00">{"x":{"filter":"none","vertical":false,"data":[["1","2"],["(Intercept)","treatmentb"],[1.0755,0.0138],[0.4588,0.6488],[2.3444,0.0212],[0.0244,0.9832],[20,20],[20,20],[1,1],[2,2],[0.1984,0.1984]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>n1<\/th>\n      <th>n2<\/th>\n      <th>x<\/th>\n      <th>s<\/th>\n      <th>sim_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":"400px","columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"term","targets":1},{"name":"estimate","targets":2},{"name":"std.error","targets":3},{"name":"statistic","targets":4},{"name":"p.value","targets":5},{"name":"n1","targets":6},{"name":"n2","targets":7},{"name":"x","targets":8},{"name":"s","targets":9},{"name":"sim_id","targets":10}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>We probably want to filter for just <code>treatmentb</code>, because we don’t care about the intercept</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(one_sim, term <span class="sc">==</span> <span class="st">"treatmentb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
  term       estimate std.error statistic p.value    n1    n2     x     s sim_id
  &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 treatmentb   0.0138     0.649    0.0212   0.983    20    20     1     2  0.198</code></pre>
</div>
</div>
<p><strong>We can replicate this many times</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>many_sims <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="fu">simTest</span>(<span class="at">n1 =</span> <span class="dv">20</span>, <span class="at">n2 =</span> <span class="dv">20</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">s =</span> <span class="dv">2</span>), <span class="at">n =</span> n_reps, <span class="at">simplify =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> <span class="co"># shoving output togther </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"treatmentb"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>many_sims                                                                                                                                                      <span class="sc">%&gt;%</span>                                               <span class="fu">mutate_if</span>(is.numeric,round,<span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span>DT<span class="sc">::</span><span class="fu">datatable</span>( <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">5</span>, <span class="at">lengthMenu =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">50</span>), <span class="at">scrollX=</span><span class="st">'400px'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ab5368624f056dad315d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ab5368624f056dad315d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500"],["treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb","treatmentb"],[0.9814000000000001,1.4108,0.9913,0.6113,1.2218,1.7526,1.7744,1.4297,1.7249,1.4492,1.6111,1.6121,1.3295,0.5331,0.9629,0.8544,2.0128,1.1117,2.1131,1.0445,0.9435,0.7286,0.725,1.4441,1.3245,-0.3949,1.1703,0.4836,1.4065,0.229,0.1001,0.7043,1.5294,0.2443,0.2344,0.08799999999999999,0.7667,1.4876,0.9852,0.2229,1.7933,1.2404,1.204,1.092,0.9849,0.5234,-0.0538,2.0188,1.2905,-0.09279999999999999,1.5853,1.9813,1.5879,0.4811,2.4566,0.8666,2.7865,1.7286,0.9354,1.2994,1.2128,1.1012,1.2354,1.368,0.9866,1.8789,1.5082,2.2759,1.0229,2.3052,0.698,1.4744,1.7724,2.1372,1.0434,0.6559,0.2589,0.4572,1.4201,1.2966,2.0194,0.9758,1.045,1.0588,1.3938,1.4066,0.3716,1.6115,1.6735,0.6081,0.1821,0.9921,1.4624,1.0242,-0.723,-0.9844000000000001,0.5427,0.5372,0.8711,2.0265,0.894,0.2823,0.3861,-0.1243,0.7877999999999999,-0.711,1.9735,0.3332,0.5455,1.5564,1.5735,0.5859,1.2076,1.7931,2.0862,2.1908,0.8794999999999999,1.212,0.555,1.4285,1.2537,-0.7739,1.7842,0.7191,0.5747,0.9938,0.1941,0.2779,0.677,0.5543,0.2502,1.895,0.9122,1.2162,0.9811,0.3432,0.0484,1.3643,0.2273,1.1994,0.0455,0.8237,1.07,-0.0622,1.0979,1.3902,0.8897,0.2057,2.1063,1.9046,1.1215,0.4233,0.0673,1.1016,1.2056,2.1792,1.2719,1.0087,1.9977,0.0852,1.2668,1.469,0.8824,1.5588,1.4105,0.6464,0.1498,1.2895,1.2443,2.1616,-0.2147,1.3536,-0.7045,-0.113,0.1885,-0.286,0.8932,0.9287,1.9326,0.0462,0.5896,1.3998,2.0525,1.7558,2.1034,1.3736,1.3669,1.343,0.4502,1.4369,1.6988,0.7433,0.5389,-0.5522,1.4285,0.6765,1.2137,1.9943,0.6711,1.1711,-0.2093,1.0288,0.8863,0.8504,0.4161,1.6054,0.5721000000000001,0.3801,0.7799,-0.5213,1.9921,0.8726,-0.0984,-0.1569,1.9122,1.4909,0.7598,0.8707,2.2395,1.5955,1.7475,0.5837,1.5809,1.3567,1.9427,-0.3108,1.505,0.5109,0.9804,0.5355,0.7568,0.5786,1.2725,0.9383,0.7027,1.1623,-0.485,1.8374,1.0327,0.4071,1.1945,1.0201,1.2608,0.762,0.4389,0.8973,0.5858,-0.134,0.9102,1.4939,0.8426,1.4756,1.246,0.7030999999999999,1.8146,0.7322,1.5776,1.7961,0.2162,0.7446,0.9233,1.2617,2.6692,0.8955,0.5151,1.0508,0.5764,1.6864,0.2551,1.2989,1.2105,1.6338,0.7344000000000001,0.6059,1.0745,1.4795,0.1474,2.4877,1.84,0.7146,1.1034,1.6382,0.6306,-0.1819,2.2124,-0.3298,1.7014,1.3519,1.9422,1.0864,-0.1921,1.0197,0.2723,-0.0015,1.1881,-0.08409999999999999,0.4462,0.6727,1.1009,1.1784,1.3779,1.2569,0.3217,0.8911,1.1155,0.6519,1.3114,2.2827,1.0146,-0.0152,1.6531,1.6799,0.9455,0.4368,0.5899,0.9066,2.3485,1.565,1.5563,0.2316,1.897,1.0381,1.1136,0.8706,2.1704,1.4201,1.8545,1.4492,0.4595,1.2261,0.7096,0.9659,1.0936,1.0826,2.198,2.0831,0.973,0.8885999999999999,0.0969,-0.0512,0.5663,2.1927,0.2718,0.9547,0.9567,0.7849,1.0339,1.3581,0.1757,0.07290000000000001,1.9909,1.9333,0.694,0.8184,1.2434,0.6751,1.497,0.323,1.0361,1.2043,0.2031,0.6461,0.4014,1.4264,1.0477,1.6038,0.3108,1.9761,0.0246,1.8162,0.3275,0.8304,-0.5688,1.9455,0.8333,1.2923,1.309,1.1132,0.6838,-0.5810999999999999,1.3614,0.8984,1.3799,1.2196,1.1624,1.1394,0.9326,1.5834,2.0967,1.8683,1.6849,1.0196,1.3956,2.3646,0.1723,0.3467,0.3961,1.7155,0.7543,0.8702,1.2834,0.9023,0.7738,1.0597,0.6756,-0.1646,1.9482,1.2336,0.9039,1.1151,-0.3064,0.589,1.0943,1.3576,0.1885,2.2028,0.4272,-0.194,0.3468,1.3499,1.4873,1.4971,0.9312,1.1462,1.2749,0.3081,0.5583,1.9646,1.38,0.9046,1.1667,0.08260000000000001,0.9530999999999999,1.2197,2.6551,1.1738,0.8933,1.0817,0.838,0.0107,0.0364,1.9595,-0.0057,1.5752,1.0887,0.9542,1.069,0.9764,-0.5474,0.8885999999999999,-0.0916,0.5668,0.9833,0.8165,0.9436,-0.7068,1.352,1.614,1.3951,1.3443,1.1607,0.6915,1.5937,-0.1795,1.8069,2.0343,0.7766999999999999,1.4206,0.1858,0.5065,2.5562,1.8208,2.0222,0.8088,-0.2697,0.6086,0.8782,1.6194,0.8447,1.2979,1.4987,0.8499,1.2262,0.9498,0.9013,0.299,0.9504,0.9678,1.1875,2.5727,1.9408,0.6212,1.0475,1.7299,0.9234,0.9674,0.8293,1.2643,2.2044,1.9225],[0.659,0.5625,0.6347,0.6522,0.643,0.6984,0.7463,0.6046,0.7383999999999999,0.6745,0.6488,0.5570000000000001,0.6127,0.6602,0.6389,0.7214,0.5713,0.5615,0.5533,0.5749,0.7289,0.5034999999999999,0.6667,0.6721,0.6142,0.7482,0.6151,0.8011,0.6567,0.5385,0.6209,0.7094,0.5623,0.7083,0.64,0.7151999999999999,0.7289,0.5845,0.5951,0.5558,0.6804,0.6651,0.6293,0.4977,0.6313,0.61,0.614,0.6274999999999999,0.6523,0.6081,0.5524,0.5957,0.6238,0.6012999999999999,0.7978,0.7438,0.6989,0.6545,0.586,0.6199,0.5274,0.6605,0.5372,0.5764,0.7073,0.5012,0.6135,0.653,0.638,0.5572,0.5566,0.5286999999999999,0.7176,0.757,0.4571,0.5377999999999999,0.5155,0.6102,0.6337,0.5887,0.6401,0.6331,0.6418,0.7143,0.7729,0.6194,0.5433,0.5236,0.6688,0.6186,0.6316000000000001,0.7645,0.6774,0.7171999999999999,0.5885,0.585,0.3979,0.5825,0.5387999999999999,0.5734,0.7633,0.6736,0.7723,0.6716,0.5163,0.6652,0.5968,0.6928,0.635,0.6122,0.4911,0.5415,0.6318,0.6303,0.5685,0.6647999999999999,0.6792,0.6153999999999999,0.6724,0.6055,0.5974,0.5396,0.6451,0.7302,0.5698,0.7117,0.5952,0.5506,0.6957,0.7472,0.5237000000000001,0.569,0.6651,0.5205,0.656,0.657,0.6439,0.5368000000000001,0.6646,0.6777,0.6096,0.6731,0.6103,0.708,0.7707000000000001,0.6196,0.7062,0.5869,0.6874,0.4701,0.6505,0.63,0.5044,0.6294,0.7304,0.5404,0.7259,0.6556,0.6367,0.6487000000000001,0.5633,0.5308,0.7139,0.5584,0.6774,0.6786,0.7005,0.5039,0.607,0.6034,0.5738,0.6374,0.6343,0.7369,0.6521,0.6962,0.6128,0.5465,0.6801,0.5986,0.6677,0.6302,0.641,0.509,0.5757,0.6393,0.6246,0.6004,0.6206,0.6546999999999999,0.5998,0.6577,0.5286999999999999,0.6618000000000001,0.6451,0.6985,0.6447000000000001,0.6578000000000001,0.7799,0.6319,0.5603,0.6306,0.661,0.8295,0.6543,0.5718,0.6543,0.5956,0.522,0.7052,0.6577,0.5789,0.6207,0.6671,0.8121,0.6656,0.6627999999999999,0.796,0.5551,0.6231,0.5835,0.6153,0.6595,0.5721000000000001,0.5633,0.702,0.5367,0.6672,0.7144,0.6352,0.6518,0.5538999999999999,0.5992,0.6018,0.4798,0.6196,0.7034,0.6733,0.6850000000000001,0.5805,0.6646,0.6244,0.5949,0.6939,0.6672,0.6196,0.5969,0.581,0.6208,0.6095,0.6109,0.6448,0.5189,0.6644,0.6727,0.6719000000000001,0.657,0.7236,0.6068,0.5858,0.5232,0.4071,0.6634,0.6987,0.6808999999999999,0.5405,0.6373,0.4943,0.5716,0.5813,0.4668,0.6202,0.6178,0.6435,0.5649,0.6745,0.6827,0.5228,0.5916,0.6132,0.5948,0.7353,0.6593,0.7346,0.5954,0.6244,0.5229,0.5198,0.5891,0.6107,0.6183999999999999,0.7091,0.6415,0.7261,0.7416,0.5652,0.6895,0.6175,0.5763,0.6149,0.5399,0.6121,0.723,0.5436,0.6443,0.5177,0.5962,0.5853,0.6367,0.5712,0.6007,0.7262999999999999,0.7033,0.7881,0.6677999999999999,0.6743,0.5633,0.6069,0.5599,0.4746,0.7362,0.6101,0.7356,0.6579,0.7377,0.6315,0.5439000000000001,0.6349,0.6457000000000001,0.5824,0.6067,0.6473,0.7239,0.5862000000000001,0.5760999999999999,0.7219,0.6476,0.4957,0.6816,0.7088,0.5222,0.7364000000000001,0.7072000000000001,0.7426,0.6703,0.5702,0.5231,0.6401,0.6044,0.6179,0.47,0.722,0.5923,0.6897,0.493,0.6319,0.6951000000000001,0.7559,0.7353,0.551,0.7382,0.7277,0.5818,0.5485,0.5537,0.64,0.6056,0.6415999999999999,0.6228,0.5778,0.6423,0.6483,0.5821,0.7002,0.7039,0.5723,0.6381,0.8502,0.6688,0.671,0.6103,0.7603,0.5212,0.7442,0.5719,0.6116,0.5929,0.6826,0.5780999999999999,0.6664,0.6661,0.6853,0.5610000000000001,0.5987,0.5659,0.622,0.5859,0.6598000000000001,0.5392,0.6219,0.5422,0.613,0.832,0.6472,0.6816,0.7365,0.6205000000000001,0.6545,0.5445,0.5765,0.5501,0.6511,0.6166,0.603,0.515,0.7944,0.6512,0.6939,0.4615,0.7155,0.5608,0.6803,0.664,0.6591,0.5516,0.6684,0.5624,0.5929,0.574,0.6143,0.6682,0.6659,0.5121,0.6395,0.5115,0.6497000000000001,0.6805,0.6633,0.6519,0.6581,0.6867,0.5987,0.5784,0.7099,0.7081,0.5897,0.6205000000000001,0.6348,0.6825,0.6204,0.5628,0.6153999999999999,0.6984,0.6863,0.517,0.6917,0.661,0.6347,0.6576,0.5259,0.6402,0.6334,0.6293,0.4923,0.6464,0.5301,0.6869,0.6387,0.6304999999999999,0.6532,0.6491,0.7318,0.6865,0.6861,0.5825,0.5755,0.6817,0.6838,0.6572,0.5445,0.6876,0.6811,0.6192,0.5486,0.634,0.5722,0.7042,0.7019,0.6391,0.6228,0.6583,0.6014,0.7153,0.592,0.603,0.6127,0.7302999999999999,0.6,0.6497000000000001,0.5525],[1.4891,2.508,1.5617,0.9372,1.9003,2.5094,2.3777,2.3649,2.336,2.1485,2.4831,2.8942,2.1699,0.8076,1.5072,1.1843,3.5231,1.9797,3.8192,1.817,1.2945,1.447,1.0874,2.1487,2.1564,-0.5278,1.9026,0.6037,2.1418,0.4252,0.1613,0.9929,2.7198,0.3449,0.3662,0.123,1.0519,2.5452,1.6555,0.4011,2.6355,1.8648,1.9133,2.1941,1.5601,0.858,-0.08749999999999999,3.2173,1.9784,-0.1526,2.87,3.326,2.5455,0.8002,3.0794,1.1651,3.9867,2.6411,1.5964,2.0963,2.2998,1.6671,2.2998,2.3732,1.3948,3.7487,2.4584,3.4851,1.6032,4.137,1.2541,2.7888,2.4698,2.8233,2.2826,1.2197,0.5022,0.7493,2.2412,2.2026,3.1546,1.5412,1.6282,1.4824,1.8033,2.2709,0.6840000000000001,3.0779,2.5023,0.983,0.2883,1.2978,2.1589,1.4281,-1.2285,-1.6828,1.3639,0.9223,1.6169,3.5342,1.1711,0.4191,0.4999,-0.1851,1.5257,-1.0689,3.307,0.4809,0.859,2.5423,3.2042,1.0819,1.9115,2.8449,3.6694,3.2956,1.2949,1.9693,0.8254,2.3594,2.0988,-1.434,2.7659,0.9848,1.0086,1.3964,0.3261,0.5048,0.9732,0.7417,0.4777,3.3301,1.3716,2.3367,1.4956,0.5224,0.0751,2.5415,0.342,1.7698,0.0746,1.2237,1.7532,-0.08790000000000001,1.4246,2.2438,1.2598,0.3505,3.0644,4.0511,1.7242,0.6719000000000001,0.1334,1.7501,1.6505,4.0322,1.7522,1.5385,3.1374,0.1313,2.2488,2.7676,1.2361,2.7914,2.0821,0.9526,0.2139,2.5593,2.0499,3.5824,-0.3742,2.1237,-1.1108,-0.1533,0.289,-0.4108,1.4575,1.6995,2.8417,0.0772,0.8829,2.2212,3.2018,3.4494,3.6535,2.1486,2.1883,2.2368,0.7255,2.1948,2.8324,1.1302,1.0194,-0.8345,2.2145,0.9685,1.8825,3.0316,0.8605,1.8532,-0.3735,1.6315,1.3408,1.0251,0.6359,2.8079,0.8744,0.6381,1.4943,-0.7392,3.029,1.5072,-0.1585,-0.2352,2.3546,2.2399,1.1464,1.0939,4.0344,2.5604,2.9951,0.9487,2.3972,2.3714,3.4487,-0.4427,2.8041,0.7657,1.3724,0.8431,1.1612,1.0444,2.1238,1.5592,1.4646,1.8759,-0.6896,2.7289,1.5076,0.7014,1.7974,1.6338,2.1193,1.0982,0.6578000000000001,1.4483,0.9813,-0.2306,1.4662,2.4508,1.3793,2.2886,2.4012,1.0583,2.6974,1.0898,2.4011,2.4822,0.3563,1.2711,1.7646,3.0994,4.0236,1.2817,0.7565,1.9441,0.9045,3.4115,0.4463,2.2344,2.5933,2.6344,1.1887,0.9417,1.902,2.1934,0.2159,4.7581,3.11,1.1653,1.8551,2.2279,0.9566,-0.2477,3.7157,-0.5282,3.254,2.6006,3.2968,1.7789,-0.3106,1.438,0.4244,-0.0021,1.6021,-0.1488,0.6472,1.0895,1.9103,1.9162,2.552,2.0533,0.4449,1.6393,1.7314,1.2594,2.1995,3.9001,1.5934,-0.0266,2.7521,2.3131,1.3443,0.5543,0.8834,1.3445,4.1692,2.5786,2.7796,0.488,2.5767,1.7017,1.5139,1.3233,2.9422,2.2488,3.4096,2.2827,0.7116,2.1054,1.1696,1.4922,1.5107,1.8469,3.8151,2.8857,1.5024,1.7928,0.1421,-0.0722,1.0843,2.9774,0.3842,1.2856,1.4273,1.3765,1.9764,2.1218,0.2907,0.1179,4.2359,2.6775,1.1717,1.1865,2.5223,1.0683,2.1538,0.4274,1.409,2.1856,0.2751,0.888,0.6899,2.6004,1.8922,2.506,0.5132,3.0799,0.0395,3.1434,0.5099,1.2809,-0.9772,2.7785,1.1838,2.2579,2.0515,1.3094,1.0224,-0.866,2.2307,1.1818,2.6476,1.6388,2.0324,1.863,1.573,2.3196,3.6267,2.8035,2.5296,1.4879,2.4878,3.9495,0.3045,0.5574,0.676,2.5999,1.3988,1.3993,2.3672,1.4718,0.9301,1.6374,0.9912,-0.2235,3.1395,1.8847,1.6602,1.9343,-0.5570000000000001,0.9045,1.7745,2.2514,0.3659,2.7728,0.6561,-0.2795,0.7514999999999999,1.8866,2.6523,2.2007,1.4025,1.739,2.3111,0.4609,0.9928,3.3133,2.4041,1.4725,1.7461,0.124,1.8611,1.9073,5.1905,1.8067,1.3127,1.6308,1.2854,0.0163,0.0531,3.2729,-0.0098,2.2189,1.5375,1.6183,1.7228,1.5381,-0.802,1.4322,-0.1628,0.921,1.408,1.1897,1.8251,-1.0219,2.0453,2.5429,2.1214,2.5562,1.813,1.0917,2.5325,-0.3646,2.7956,3.8376,1.1308,2.2243,0.2947,0.7754,3.9379,2.4882,2.9458,1.1788,-0.463,1.0575,1.2883,2.3682,1.2852,2.3836,2.1796,1.2478,1.9803,1.7312,1.4217,0.5225,1.3496,1.3789,1.8579,4.1312,2.9484,1.0329,1.4644,2.9222,1.5313,1.5788,1.1356,2.1071,3.3932,3.4797],[0.1447,0.0165,0.1266,0.3546,0.065,0.0165,0.0226,0.0232,0.0249,0.0381,0.0176,0.0063,0.0363,0.4244,0.14,0.2436,0.0011,0.055,0.0005,0.0771,0.2033,0.1561,0.2837,0.0381,0.0374,0.6007,0.06469999999999999,0.5496,0.0387,0.6731,0.8727,0.327,0.0098,0.7321,0.7161999999999999,0.9026999999999999,0.2995,0.0151,0.1061,0.6906,0.0121,0.0699,0.0633,0.0344,0.127,0.3963,0.9307,0.0026,0.0552,0.8794999999999999,0.0067,0.002,0.0151,0.4286,0.0038,0.2512,0.0003,0.0119,0.1187,0.0428,0.027,0.1037,0.027,0.0228,0.1712,0.0005999999999999999,0.0186,0.0013,0.1172,0.0002,0.2175,0.008200000000000001,0.0181,0.0075,0.0281,0.2301,0.6183999999999999,0.4583,0.0309,0.0338,0.0031,0.1315,0.1117,0.1465,0.0793,0.0289,0.4981,0.0039,0.0168,0.3318,0.7747000000000001,0.2022,0.0372,0.1614,0.2268,0.1006,0.1806,0.3622,0.1142,0.0011,0.2488,0.6775,0.62,0.8542,0.1354,0.2918,0.0021,0.6334,0.3957,0.0152,0.0027,0.2861,0.0635,0.0071,0.0007,0.0021,0.2032,0.0562,0.4143,0.0235,0.0425,0.1597,0.008699999999999999,0.3309,0.3195,0.1707,0.7461,0.6166,0.3366,0.4628,0.6356000000000001,0.0019,0.1782,0.0248,0.143,0.6044,0.9405,0.0152,0.7342,0.0848,0.9409,0.2286,0.0876,0.9304,0.1624,0.0307,0.2154,0.7279,0.004,0.0002,0.09279999999999999,0.5057,0.8946,0.0882,0.1071,0.0003,0.0878,0.1322,0.0033,0.8962,0.0304,0.008699999999999999,0.224,0.008200000000000001,0.0441,0.3468,0.8318,0.0146,0.0473,0.001,0.7103,0.0403,0.2736,0.879,0.7741,0.6836,0.1532,0.0974,0.0072,0.9389,0.3828,0.0324,0.0028,0.0014,0.0008,0.0381,0.0349,0.0312,0.4726,0.0344,0.0074,0.2655,0.3145,0.4092,0.0329,0.3389,0.0674,0.0044,0.3949,0.0716,0.7108,0.1111,0.1879,0.3118,0.5286,0.0078,0.3874,0.5272,0.1434,0.4643,0.0044,0.14,0.8749,0.8153,0.0238,0.031,0.2588,0.2809,0.0003,0.0146,0.0048,0.3488,0.0215,0.0229,0.0014,0.6605,0.007900000000000001,0.4486,0.178,0.4045,0.2528,0.3029,0.0403,0.1272,0.1513,0.0684,0.4947,0.009599999999999999,0.1399,0.4873,0.08019999999999999,0.1106,0.0407,0.279,0.5145999999999999,0.1557,0.3326,0.8188,0.1508,0.019,0.1759,0.0278,0.0213,0.2966,0.0104,0.2827,0.0213,0.0176,0.7236,0.2114,0.0857,0.0036,0.0003,0.2077,0.454,0.0593,0.3715,0.0015,0.6579,0.0314,0.0134,0.0121,0.2419,0.3523,0.0648,0.0345,0.8302,0,0.0035,0.2512,0.0713,0.0319,0.3448,0.8057,0.0005999999999999999,0.6004,0.0024,0.0132,0.0021,0.0833,0.7578,0.1586,0.6737,0.9983,0.1174,0.8825,0.5214,0.2828,0.06370000000000001,0.0629,0.0149,0.047,0.6589,0.1094,0.0915,0.2156,0.034,0.0004,0.1194,0.9789,0.008999999999999999,0.0262,0.1868,0.5826,0.3826,0.1868,0.0002,0.0139,0.008399999999999999,0.6284,0.014,0.097,0.1383,0.1937,0.0055,0.0304,0.0016,0.0281,0.4811,0.0419,0.2495,0.1439,0.1391,0.0726,0.0005,0.0064,0.1413,0.081,0.8878,0.9428,0.2851,0.005,0.7029,0.2064,0.1617,0.1767,0.0554,0.0404,0.7729,0.9067,0.0001,0.0109,0.2486,0.2428,0.016,0.2921,0.0377,0.6715,0.167,0.0351,0.7847,0.3802,0.4945,0.0132,0.06610000000000001,0.0166,0.6108,0.0038,0.9687,0.0032,0.6131,0.208,0.3347,0.008399999999999999,0.2438,0.0298,0.0472,0.1983,0.313,0.3919,0.0317,0.2446,0.0117,0.1095,0.0491,0.0702,0.124,0.0258,0.0008,0.007900000000000001,0.0157,0.145,0.0174,0.0003,0.7624,0.5805,0.5031,0.0132,0.17,0.1698,0.0231,0.1493,0.3582,0.1098,0.3278,0.8243,0.0033,0.06710000000000001,0.1051,0.0605,0.5808,0.3714,0.08400000000000001,0.0302,0.7165,0.0086,0.5157,0.7814,0.457,0.0669,0.0116,0.0339,0.1689,0.0901,0.0263,0.6475,0.3271,0.002,0.0212,0.1491,0.08890000000000001,0.902,0.07049999999999999,0.0641,0,0.07870000000000001,0.1971,0.1112,0.2064,0.9871,0.958,0.0023,0.9922,0.0325,0.1325,0.1139,0.0931,0.1323,0.4275,0.1603,0.8715000000000001,0.3629,0.1673,0.2415,0.0759,0.3133,0.0478,0.0152,0.0405,0.0147,0.07770000000000001,0.2818,0.0156,0.7174,0.0081,0.0005,0.2652,0.0321,0.7698,0.4429,0.0003,0.0173,0.0055,0.2458,0.646,0.2969,0.2054,0.0231,0.2065,0.0222,0.0356,0.2197,0.0549,0.0915,0.1633,0.6042999999999999,0.1851,0.176,0.0709,0.0002,0.0054,0.3082,0.1513,0.0058,0.134,0.1227,0.2632,0.0418,0.0016,0.0013],[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],[0.2173,0.2694,0.9943,0.6292,0.1373,0.7618,0.375,0.1701,0.2737,0.0799,0.8229,0.1748,0.7298,0.5894,0.9801,0.9534,0.6036,0.102,0.3334,0.7317,0.3079,0.0645,0.9334,0.909,0.4047,0.831,0.1458,0.9464,0.0506,0.0479,0.8443000000000001,0.5436,0.518,0.9055,0.5814,0.6112,0.6248,0.7222,0.9201,0.7213000000000001,0.1238,0.3289,0.86,0.08110000000000001,0.7089,0.9046999999999999,0.4519,0.4444,0.1588,0.4631,0.1496,0.8267,0.7413999999999999,0.7776999999999999,0.4171,0.1556,0.5122,0.5043,0.0333,0.7374000000000001,0.5432,0.2728,0.1821,0.2747,0.7561,0.1493,0.5469000000000001,0.1801,0.8457,0.6361,0.9076,0.5737,0.8403,0.9916,0.6163999999999999,0.1855,0.3678,0.3395,0.7141,0.1158,0.8789,0.7996,0.1806,0.8279,0.0638,0.1943,0.7201,0.4654,0.508,0.8087,0.4337,0.5928,0.8406,0.8385,0.7665999999999999,0.2131,0.3462,0.6479,0.2871,0.2214,0.8841,0.1888,0.5600000000000001,0.4483,0.6725,0.9795,0.5657,0.2006,0.0108,0.9762,0.235,0.6508,0.3171,0.8335,0.609,0.3576,0.1413,0.3641,0.029,0.9026,0.7919,0.5805,0.5777,0.3377,0.5394,0.08500000000000001,0.8977000000000001,0.5362,0.4472,0.3966,0.6906,0.4298,0.9893999999999999,0.3166,0.8401,0.5887,0.2945,0.6437,0.1677,0.4705,0.7167,0.6103,0.6414,0.8300999999999999,0.3579,0.8599,0.4764,0.413,0.7108,0.2933,0.5347,0.8657,0.9169,0.4835,0.1551,0.0518,0.9509,0.2847,0.0443,0.4806,0.7604,0.9697,0.763,0.0621,0.5921,0.6861,0.8515,0.4318,0.9913999999999999,0.3202,0.9731,0.4473,0.798,0.0003,0.2091,0.6973,0.8125,0.4151,0.9671,0.0152,0.4875,0.4929,0.0974,0.293,0.2271,0.8814,0.3119,0.8004,0.5867,0.5002,0.2078,0.5888,0.0371,0.4017,0.4096,0.6516,0.2248,0.1953,0.6213,0.2083,0.2167,0.7857,0.4832,0.7533,0.3162,0.5465,0.3549,0.5294,0.4837,0.3635,0.0481,0.534,0.6697,0.5086000000000001,0.8974,0.1927,0.4944,0.3041,0.0583,0.357,0.8575,0.2452,0.2053,0.6861,0.7059,0.4623,0.4718,0.7875,0.9552,0.4153,0.926,0.0819,0.1764,0.1364,0.8284,0.3015,0.3533,0.2541,0.7476,0.5196,0.7806,0.09950000000000001,0.726,0.5551,0.833,0.4971,0.5104,0.2888,0.4772,0.2567,0.8239,0.6195000000000001,0.9078000000000001,0.4283,0.1633,0.1974,0.4366,0.3358,0.9649,0.0223,0.9345,0.9373,0.465,0.2153,0.9603,0.5921,0.9851,0.8062,0.7789,0.4786,0.0857,0.1753,0.7708,0.8566,0.4328,0.3618,0.7583,0.8874,0.2,0.7516,0.8332000000000001,0.8847,0.8127,0.3195,0.387,0.7585,0.7778,0.613,0.4709,0.7437,0.1382,0.9061,0.4737,0.6988,0.8742,0.474,0.4751,0.0379,0.5575,0.8385,1,0.8821,0.2655,0.0266,0.5947,0.8895,0.8016,0.108,0.4636,0.2072,0.2557,0.518,0.1039,0.7823,0.0536,0.3752,0.2019,0.5023,0.8101,0.1579,0.3039,0.3458,0.8054,0.4218,0.7805,0.9285,0.2592,0.0375,0.1703,0.442,0.4073,0.6284,0.72,0.6501,0.483,0.6717,0.4866,0.0525,0.8522,0.6519,0.3117,0.1104,0.979,0.6347,0.488,0.8685,0.2366,0.5911,0.2353,0.3989,0.2518,0.2947,0.0804,0.4683,0.4587,0.3563,0.0316,0.6676,0.464,0.0319,0.9159,0.5699,0.4504,0.9458,0.5931999999999999,0.9136,0.2229,0.2926,0.0209,0.7567,0.1868,0.9563,0.5827,0.0772,0.6532,0.963,0.9681,0.7949000000000001,0.0982,0.4597,0.773,0.4291,0.0247,0.6087,0.5773,0.4568,0.3262,0.5598,0.9754,0.6318,0.2389,0.3683,0.0411,0.2371,0.4115,0.8372000000000001,0.9988,0.3355,0.6787,0.785,0.4224,0.3809,0.0694,0.3827,0.4317,0.5295,0.9661,0.1018,0.7205,0.2797,0.4172,0.796,0.9842,0.5715,0.8435,0.0468,0.08359999999999999,0.7166,0.5968,0.3203,0.2863,0.1575,0.8278,0.2682,0.4546,0.4349,0.4747,0.6860000000000001,0.2081,0.7224,0.9018,0.588,0.9583,0.4064,0.4454,0.2829,0.2434,0.8270999999999999,0.8406,0.8893,0.798,0.4263,0.891,0.6234,0.9834000000000001,0.2604,0.7117,0.9194,0.3534,0.8218,0.0022,0.3563,0.5684,0.3941,0.3839,0.2881,0.8245,0.8318,0.3885,0.5264,0.3926,0.5074,0.1526,0.5982,0.8401,0.3592,0.07049999999999999,0.7962,0.338,0.4535,0.7191,0.6317,0.4229,0.6775,0.2327,0.3676,0.8155,0.2631,0.1425,0.6056,0.9554,0.7567,0.5669999999999999,0.5613,0.8954,0.0553,0.6838,0.5232,0.4749,0.6325,0.7355,0.9127,0.9431,0.1397,0.246,0.5810999999999999,0.4914,0.2926,0.4635,0.0931]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>n1<\/th>\n      <th>n2<\/th>\n      <th>x<\/th>\n      <th>s<\/th>\n      <th>sim_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"lengthMenu":[5,25,50],"scrollX":"400px","columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"term","targets":1},{"name":"estimate","targets":2},{"name":"std.error","targets":3},{"name":"statistic","targets":4},{"name":"p.value","targets":5},{"name":"n1","targets":6},{"name":"n2","targets":7},{"name":"x","targets":8},{"name":"s","targets":9},{"name":"sim_id","targets":10}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We can summarize this output to look at our power and the standard deviation, and upport and lower 2.5% quantiles to estimate our precision</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>many_sims <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">power        =</span> <span class="fu">mean</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_est     =</span> <span class="fu">mean</span>(estimate),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_est       =</span> <span class="fu">sd</span>(estimate),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower_95_est =</span> <span class="fu">quantile</span>(estimate, <span class="at">prob =</span> <span class="fl">0.025</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">upper_95_est =</span> <span class="fu">quantile</span>(estimate, <span class="at">prob =</span> <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  power mean_est sd_est lower_95_est upper_95_est
  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1 0.378     1.02  0.678       -0.364         2.23</code></pre>
</div>
</div>
<p>We can turn this last bit into a function and try it for a bunch of sample sizes</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
      n power mean_est sd_est lower_95_est upper_95_est
  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1    10 0.178    1.03   0.900       -0.677         2.81
2    20 0.3      0.951  0.603       -0.155         2.07
3    50 0.694    1.00   0.405        0.249         1.88
4   100 0.946    0.999  0.276        0.427         1.55</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inferring-causation-when-we-cant-do-experiments" class="level2">
<h2 class="anchored" data-anchor-id="inferring-causation-when-we-cant-do-experiments">Inferring causation when we can’t do experiments</h2>
<p>Experiments are our best way to learn about causation, but we can’t always do experiments. Sometimes experiments are unethical, impractical, or impossible. Do we have any hope of inferring causation in these cases? The short answer is – sometimes, if we’re lucky.</p>
<p>One good way to make causal claims from observational studies is to find matches, or “natural experiments” in which the variable we cared about changed in one set of cases, but did not in paired cases that are similar in every way except this change. If we cannot make a rigorous causal claim it is best not to pretend we can. Rather, we should honestly describe what we can and cannot infer from our data.</p>
<p>The next chapter goes into the problem of “causal inference” in more detail.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-higgins2024" class="csl-entry" role="listitem">
Higgins, P. D. R. (2024). <em>Reproducible medical research with r</em>. Bookdown. <a href="https://bookdown.org/pdr_higgins/rmrwr/">https://bookdown.org/pdr_higgins/rmrwr/</a>
</div>
<div id="ref-whitlock2020" class="csl-entry" role="listitem">
Whitlock, M. C., &amp; Schluter, D. (2020). <em>The analysis of biological data</em> (Third). Macmillan.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../book_sections/model_evaluation.html" class="pagination-link" aria-label="24. Model Evaluation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">24. Model Evaluation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../book_sections/causal_inference.html" class="pagination-link" aria-label="26. Cause">
        <span class="nav-page-text">26. Cause</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>