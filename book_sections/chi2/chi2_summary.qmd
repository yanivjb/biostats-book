## â€¢ 14B. $\chi^2$ summary {.unnumbered #chi2_summary}


---
format: html
webr:
  packages: ['dplyr', 'readr' ,'ggplot2','infer']
  autoload-packages: true
---


```{r}
#| echo: false
#| message: false
#| warning: false
library(webexercises)
library(dplyr)
library(knitr)
library(infer)
library(ggplot2)
library(tidyr)
library(palmerpenguins)
library(janitor)
library(dplyr)
long_spider <- tibble(first_male = c("Eaten", "Eaten", "Escaped", "Escaped"),
       second_male = c("Accepted","Rejected","Accepted","Rejected"),
       count = c(3,6,22,1))

wide_spider <- pivot_wider(long_spider,names_from = second_male, values_from = count)
```

```{webr-r}
#| context: setup
library(janitor)
library(dplyr)
library(ggplot)
library(infer)
library(tidyr)
long_spider <- tibble(first_male = c("Eaten", "Eaten", "Escaped", "Escaped"),
       second_male = c("Accepted","Rejected","Accepted","Rejected"),
       count = c(3,6,22,1))

wide_spider <- pivot_wider(long_spider,names_from = second_male, values_from = count)
```

## Links to: 

[Summary](#chi2_summary_chapter-summary). [Chatbot tutor](#chi2_summary_chatbot_tutor).  [Questions](#chi2_summary_practice-questions). [Glossary](#chi2_summary_glossary-of-terms). [R packages](#chi2_summaryR_packages_introduced). [R functions](#chi2_summary_key-r-functions). [More resources](#chi2_summary_additional-resources).


```{r}
#| echo: false
#| column: margin
include_graphics("https://media.makeameme.org/created/when-the-chi-30af13d4f4.jpg")  
```

## Chapter summary {#chi2_summary_chapter-summary}  

The Ï‡Â² test-statistic quantifies the difference between observed and expected counts of categorical variables. By comparing an observed  $\chi^2$ value to its null distribution (generated by simulation, permutation, or math) we can caclulate p-values and conduct NHST.



### Chatbot tutor  {#chi2_summary_chatbot_tutor} 

:::tutor


Please interact with this custom chatbot ([**link here**](https://chatgpt.com/g/g-68e48d72f2508191a1b3b0024158eaca-chi2-tutor)). I have made to help you with this chapter. I suggest interacting with at least ten back-and-forths to ramp up  and then stopping when you feel like you got what you needed from it. 

:::


## Practice Questions {#chi2_summary_practice-questions}


Try these questions! By using the R environment you can work without leaving this "book". I even pre-loaded all the packages you need! 

---

**SETUP:** Sometimes female Latrodectus hasselti (redback spiders) eat their mates. Is there anything in it for the males? Maydianne Andrade tested the idea that eating a male might prevent her from re-mating with a second male â€“ that is if sheâ€™s too preoccupied eating/digesting her mate that sheâ€™s not looking to mate again. She observed whether a female accepted a second male after the first male either escaped or was eaten. [link](https://www.science.org/doi/10.1126/science.271.5245.70). 



I have these data:

- In long format with three columns (`first_male`, `second_male`, and `count`), and four columns in a tibble called  `long_spider`.   

- In wide format as a contingency table with three columns (`first_male`, `Accepted`, and `Rejected` (both refer to second male)), with eaten and escaped as count data, in a tibble called `widespider`.
first_male Accepted Rejected

```{r}
#| column: page-right
#| echo: false
include_graphics("https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/Latrodectus_hasselti_close.jpg/500px-Latrodectus_hasselti_close.jpg")
```


```{webr-r}
long_spider <- tibble(first_male = c("Eaten", "Eaten", "Escaped", "Escaped"),
       second_male = c("Accepted","Rejected","Accepted","Rejected"),
       count = c(3,6,22,1))

wide_spider <- pivot_wider(long_spider,names_from = second_male, values_from = count)

```

:::exercises

**Q1)** This study is `r mcq(c("Bootstrap", answer = "Observational", "Expiremental"))`


---

**Q2)** Plot the data. Which trend is apparent?


`r longmcq(c("There is no obvious trend", "Following cannibalistic mating females are more likely to accept a second suitor", answer= "Following cannibalistic mating females are less likely to accept a second suitor"))`



--- 

**Q3) **Assuming independence, how many cases do you expect when the first male is eaten and the second male is accepted?  `r fitb(answer =7 ,num = TRUE,tol = 0.05)`

`r hide("Explanation")`
- $P_{first male eaten}$ =9/32. 
- $P_{second male accpeted}$ =25/32. 

$\frac{9}{32} \times \frac{25}{32} \times 32 = 7.03$

`r unhide()`

--- 

**Q4)** What is the (two-tailed) null hypothesis? `r longmcq(c(
answer = "There is no association being eaten & your mate rejecting a second male", "Being eaten is not associated with a lower chance of your mate rejecting a second male", "There is an association being eaten & your mate rejecting a second male"))`

--- 

**Q5)** What is the (two-tailed) alternative hypothesis? `r longmcq(c("There is no association being eaten & your mate rejecting a second male", "Being eaten is not associated with a lower chance of your mate rejecting a second male", answer =  "There is an association being eaten & your mate rejecting a second male"))`

---

```{r}
wide_spider |> 
  select(-1)|> # remve the label column that does not have numbers
  chisq.test()
```

---

**Q6)** Given our test, `r longmcq(c(answer = "We reject the null", "We fail to reject the null","We accept the null", "We fail to accept the null"))`

:::


## ğŸ“Š Glossary of Terms {#chi2_summary_glossary-of-terms} 

:::glossary


### **Glossary: Ï‡Â² (Chi-Squared) Tests**

* **Chi-Squared (Ï‡Â²) Statistic**: A measure of how far observed counts differ from expected counts under a null model. Larger Ï‡Â² values indicate greater deviation from expectation.

* **Chi-Squared Distribution**: A probability distribution that describes the sampling distribution of the Ï‡Â² statistic when the null hypothesis is true. It depends only on the number of degrees of freedom.

* **Degrees of Freedom (df)**: The number of independent values that can vary in a dataset after certain constraints are applied. For a Ï‡Â² test, this typically equals the number of categories minus one (for goodness-of-fit) or (rows âˆ’ 1) Ã— (columns âˆ’ 1) for contingency tables.

* **Goodness-of-Fit Test**: A Ï‡Â² test used to assess whether observed frequencies across categories differ significantly from expected frequencies based on a specific theoretical distribution.

* **Contingency (or Independence) Test**: A Ï‡Â² test used to evaluate whether two categorical variables are independent. Observed frequencies in a contingency table are compared to the frequencies expected if there were no association.


:::


---

## R Packages Introduced  {#chi2_summaryR_packages_introduced}   

:::packages

There a re no new packages, but we continue to use **[`infer`](https://infer.netlify.app/):** this time for permutation. 

:::

---

## ğŸ› ï¸ Key R Functions{#chi2_summary_key-r-functions}  

 
:::functions
Hereâ€™s the matching summary for the **chi-square functions**:

---

* `chisq.test()`:  Performs a chi-square test (ether a goodness-of-fit, or a contingency test). Returns the Ï‡Â² statistic, degrees of freedom, and p-value.

```{r}
#| eval: false
chisq.test(table(species, visited), correct = FALSE)
```

---

* `pchisq()`: Looks up p-values or cumulative probabilities from the theoretical chi-square distribution. Used to compute p-values from a $\chi^2$ calculation/ Example:

```{r}
#| eval: false
pchisq(chi2_stat, df = 1, lower.tail = FALSE)
```

---

:::



## Additional resources   {#chi2_summary_additional-resources}

:::learnmore 

**Videos:**         

-  [Crash course statistics $\chi^2$](https://www.youtube.com/watch?v=7_cs1YlZoug)
:::


