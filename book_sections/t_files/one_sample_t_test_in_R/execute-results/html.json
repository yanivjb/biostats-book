{
  "hash": "abcbd2bae11b60da3f17d3032d20b590",
  "result": {
    "engine": "knitr",
    "markdown": "## â€¢ 16. One sample t-test in R  {.unnumbered #one_sample_t_test_in_R}\n\n\n\n::: {.cell}\n\n:::\n\n\n::: {.motivation style=\"background-color: #ffe6f7; padding: 10px; border: 1px solid #ddd; border-radius: 5px;\"}\n\n**Motivating Example:** You understand the t-distribution, and using it for estimating uncertainty and testing the null that a mean equals $\\mu_0$. But it's a lot of work to do this. If only there were an easier way ðŸ¤”. Here, we show how R can do this for us.   \n\n**Learning Goals:** By the end of this section, you will be able to:\n\n1.  **Perform** a one-sample t-test using the `t.test()` function.\n2.  **Use** the `broom` package (`tidy()`, `augment()`) to generate clean, predictable output from model objects.\n3.  **Frame** a one-sample t-test as a simple linear model using the `lm()` function.\n4.  **Interpret** the output of `summary()` for a simple linear model.\n\n:::\n\n\n\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Code to load and process data\"}\nlibrary(tidyr)\nlibrary(dplyr)\nrange_shift_file <- \"https://whitlockschluter3e.zoology.ubc.ca/Data/chapter11/chap11q01RangeShiftsWithClimateChange.csv\"\nrange_shift <- read_csv(range_shift_file) |>\n  mutate(uphill = elevationalRangeShift > 0)|>\n  separate(taxonAndLocation, into = c(\"taxon\", \"location\"), sep = \"_\")\n```\n:::\n\n\n## Stats in R\n\n> \"What does a one-sample t-test in R mean\", you ask, realizing we just did that. Let me explain... \n\n\n::: {.cell .column-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![R can make things easy! Image made with ChatGPT.](../../figs/linear_models/t/easy_peasy.png){#fig-easypeezy fig-align='center' fig-alt='A poster saying \"Easy peasy lemon squeezy.\"' width=95%}\n:::\n:::\n\n\nWe just worked through the calculations for a confidence interval and a hypothesis test step by step. But R can do this for us in a single line.  Now that you know how it works and what R is doing, I can show you how to have R do this work for you.\n\n## t.test()   \n\n\nThe [`t.test()`](https://stat.ethz.ch/R-manual/R-devel/library/stats/html/t.test.html) function is the easiest way to run a one-sample t-test in R. There are two relevant arguments:      \n\n- `x`: A vector of observations.   \n- `mu`: $\\mu_0$ -- i.e. the expected value of `x` under the null hypothesis.  \n\n:::aside\n**Note:** Because `x` must be a vector, I `pull()` it out of its tibble.\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nt.test(x = pull(range_shift,elevationalRangeShift) , mu = 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  pull(range_shift, elevationalRangeShift)\nt = 7.1413, df = 30, p-value = 0.00000006057\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 28.08171 50.57635\nsample estimates:\nmean of x \n 39.32903 \n```\n\n\n:::\n:::\n\n\n---\n\n### Tidying up R model outputs\n\nThe output of `t-test()` includes:  \n\n- The test statistic, *t*.  \n- The degrees of freedom.  \n- The p-value.  \n- The 95% confidence interval.  \n- The sample estimate (in this case the mean).     \n\nWhile all of these results match our calculations (and are faster and easier to do), there is one problem -- they are a mess. That is, they are stored in a format that you can read, but it's not easy to process with a computer. The [`tidy()`](https://broom.tidymodels.org/reference/tidy.lm.html) function in  the [`broom`](https://broom.tidymodels.org/) package offers a convenient format:   \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(broom)\nt.test(x = pull(range_shift,elevationalRangeShift) , mu = 0) |>\n  tidy() \n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"qeunlljedj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qeunlljedj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qeunlljedj thead, #qeunlljedj tbody, #qeunlljedj tfoot, #qeunlljedj tr, #qeunlljedj td, #qeunlljedj th {\n  border-style: none;\n}\n\n#qeunlljedj p {\n  margin: 0;\n  padding: 0;\n}\n\n#qeunlljedj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qeunlljedj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qeunlljedj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qeunlljedj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qeunlljedj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qeunlljedj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qeunlljedj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qeunlljedj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qeunlljedj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qeunlljedj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qeunlljedj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qeunlljedj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qeunlljedj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qeunlljedj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qeunlljedj .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qeunlljedj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qeunlljedj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qeunlljedj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qeunlljedj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qeunlljedj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qeunlljedj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qeunlljedj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qeunlljedj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qeunlljedj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qeunlljedj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qeunlljedj .gt_left {\n  text-align: left;\n}\n\n#qeunlljedj .gt_center {\n  text-align: center;\n}\n\n#qeunlljedj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qeunlljedj .gt_font_normal {\n  font-weight: normal;\n}\n\n#qeunlljedj .gt_font_bold {\n  font-weight: bold;\n}\n\n#qeunlljedj .gt_font_italic {\n  font-style: italic;\n}\n\n#qeunlljedj .gt_super {\n  font-size: 65%;\n}\n\n#qeunlljedj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qeunlljedj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qeunlljedj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qeunlljedj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qeunlljedj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qeunlljedj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qeunlljedj .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qeunlljedj .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qeunlljedj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>t.test() output piped through broom's tidy() function</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parameter\">parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"method\">method</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"alternative\">alternative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"estimate\" class=\"gt_row gt_right\">39.33</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">7.14</td>\n<td headers=\"p.value\" class=\"gt_row gt_left\">6.06e-08</td>\n<td headers=\"parameter\" class=\"gt_row gt_right\">30</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">28.08</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">50.58</td>\n<td headers=\"method\" class=\"gt_row gt_left\">One Sample t-test</td>\n<td headers=\"alternative\" class=\"gt_row gt_left\">two.sided</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::aside\n**The `statistic` here is the t-value.** The `statistic` column will contain the value of whichever test statistic your analysis produces.\n:::\n\n\n## The general linear model framework in R\n\nAn alternative approach to the  `t.test()` function is to use the R's framework for linear models. Remember that a linear model predicts the value of the response variable of the $i^{th}$ observation $\\hat{Y_i}$ as a function of things in our model. For a one sample t-test, our model only contains the mean, which we represent as the \"intercept\", $a$:      \n\n$$\\hat{Y_i} = a$$\n\nOf course, actual observations $Y_i$, will deviate from model predictions. This deviation, known as the \"residual\" is shown as $e_i$:   \n\n$$Y_i = \\hat{Y_i} + e_i$$\n$$Y_i =  a+e_i$$\n\nThe `lm()` function in `R` builds such linear models. If we are only modelling the mean, the syntax is:     \n\n- `lm(y ~ 1)` if `y` is a  vector, or   \n- `lm(y ~ 1, data = dataset)` if `y` is a column in a tibble (or dataframe)   \n\nHere the `1` ells R to fit the simplest possible model: an intercept-only model. The estimate for this intercept will be the overall mean of our response variable:    \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlm(elevationalRangeShift ~ 1, data = range_shift)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = elevationalRangeShift ~ 1, data = range_shift)\n\nCoefficients:\n(Intercept)  \n      39.33  \n```\n\n\n:::\n:::\n\n\n---\n\n:::fyi\nThis may seem like overkill for a one-sample t-test, but the linear model framework generalizes to regression, ANOVA, and more. Seeing a one-sample t-test as a linear model prepares us for the models weâ€™ll meet next.\n:::\n\n### summary() provides p-values and test statistics  \n\n`lm()` just returns the mean, but it actually calculates so much more! To access information like the standard error, t-value, p value (reported as `Pr(>|t|)`), and degrees of freedom,  pipe the output to [`summary()`](https://stat.ethz.ch/R-manual/R-devel/library/stats/html/summary.lm.html):     \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlm(elevationalRangeShift ~ 1, data = range_shift) |>\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = elevationalRangeShift ~ 1, data = range_shift)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-58.629 -23.379  -3.529  24.121  69.271 \n\nCoefficients:\n            Estimate Std. Error t value     Pr(>|t|)    \n(Intercept)   39.329      5.507   7.141 0.0000000606 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 30.66 on 30 degrees of freedom\n```\n\n\n:::\n:::\n\n\n---\n\n### tidy() cleans up the output  \n\nAs above, we can use [`broom`](https://broom.tidymodels.org/)'s [`tidy()`](https://broom.tidymodels.org/reference/tidy.lm.html) function to turn this output into a more convenient format:     \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(broom)\nlm(elevationalRangeShift ~ 1, data = range_shift) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 Ã— 5\n  term        estimate std.error statistic      p.value\n  <chr>          <dbl>     <dbl>     <dbl>        <dbl>\n1 (Intercept)     39.3      5.51      7.14 0.0000000606\n```\n\n\n:::\n:::\n\n\n---\n\n\n::: {.cell .column-margin layout-align=\"center\"}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"jhlawytdfg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#jhlawytdfg table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jhlawytdfg thead, #jhlawytdfg tbody, #jhlawytdfg tfoot, #jhlawytdfg tr, #jhlawytdfg td, #jhlawytdfg th {\n  border-style: none;\n}\n\n#jhlawytdfg p {\n  margin: 0;\n  padding: 0;\n}\n\n#jhlawytdfg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jhlawytdfg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jhlawytdfg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jhlawytdfg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jhlawytdfg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jhlawytdfg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jhlawytdfg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jhlawytdfg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jhlawytdfg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jhlawytdfg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jhlawytdfg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jhlawytdfg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jhlawytdfg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jhlawytdfg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jhlawytdfg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhlawytdfg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jhlawytdfg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jhlawytdfg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jhlawytdfg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhlawytdfg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jhlawytdfg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhlawytdfg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jhlawytdfg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhlawytdfg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jhlawytdfg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhlawytdfg .gt_left {\n  text-align: left;\n}\n\n#jhlawytdfg .gt_center {\n  text-align: center;\n}\n\n#jhlawytdfg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jhlawytdfg .gt_font_normal {\n  font-weight: normal;\n}\n\n#jhlawytdfg .gt_font_bold {\n  font-weight: bold;\n}\n\n#jhlawytdfg .gt_font_italic {\n  font-style: italic;\n}\n\n#jhlawytdfg .gt_super {\n  font-size: 65%;\n}\n\n#jhlawytdfg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jhlawytdfg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jhlawytdfg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jhlawytdfg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jhlawytdfg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jhlawytdfg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jhlawytdfg .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#jhlawytdfg .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#jhlawytdfg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Fitted values and residuals from augment()</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"elevationalRangeShift\">elevationalRangeShift</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.fitted\">.fitted</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a.resid\">.resid</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"elevationalRangeShift\" class=\"gt_row gt_right\">58.9</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">39.329</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">19.571</td></tr>\n    <tr><td headers=\"elevationalRangeShift\" class=\"gt_row gt_right\">7.8</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">39.329</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">-31.529</td></tr>\n    <tr><td headers=\"elevationalRangeShift\" class=\"gt_row gt_right\">108.6</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">39.329</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">69.271</td></tr>\n    <tr><td headers=\"elevationalRangeShift\" class=\"gt_row gt_right\">44.8</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">39.329</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">5.471</td></tr>\n    <tr><td headers=\"elevationalRangeShift\" class=\"gt_row gt_right\">11.1</td>\n<td headers=\".fitted\" class=\"gt_row gt_right\">39.329</td>\n<td headers=\".resid\" class=\"gt_row gt_right\">-28.229</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n### augment() shows residuals (and more)\n\n[`broom`](https://broom.tidymodels.org/)'s [`augment()`](https://broom.tidymodels.org/reference/augment.lm.html) function shows each observation's the actual value, predicted  value (`.fitted`) and residual (`.resid`).  I'm only showing the first three columns because they are the only ones we've covered so far, and I only show the first five rows to save space.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(broom)\nlm(elevationalRangeShift ~ 1, data = range_shift) |>\n  augment()|>\n  select(1:3)|>\n  slice_head(n = 5)\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}